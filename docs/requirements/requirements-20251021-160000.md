# Requirements Specification - Decentralized Autonomous Forum
**Generated By**: Plan Agent
**Date**: 2025-10-21 16:00:00
**Project**: project-20251021-092500-decentralized-forum
**Version**: 1.0
**Status**: Approved for Development

---

## Document Control

| Version | Date | Author | Changes |
|---------|------|--------|---------|
| 1.0 | 2025-10-21 | Plan Agent | Initial requirements specification based on Product Agent analysis |

---

## Executive Summary

This document defines the complete functional and non-functional requirements for the Decentralized Autonomous Forum platform. Requirements are derived from:
- **Init Agent**: project-requirements-20251021-092500.md
- **Product Agent**: product-strategy, market-research, feature-prioritization documents
- **Online Research**: Industry standards (ISO 25010, IEEE 830, WCAG 2.1)

**Scope**: 22 MVP features (6 months) + 15 Phase 2 features (Months 7-12)
**Target**: 10,000 MAU, $12K/month revenue by Month 12 (October 2026)

---

## Table of Contents

1. [Functional Requirements](#1-functional-requirements)
2. [Non-Functional Requirements](#2-non-functional-requirements)
3. [Technical Requirements](#3-technical-requirements)
4. [Security Requirements](#4-security-requirements)
5. [Compliance Requirements](#5-compliance-requirements)
6. [Success Criteria](#6-success-criteria)
7. [Requirements Traceability Matrix](#7-requirements-traceability-matrix)

---

## 1. Functional Requirements

### 1.1 Authentication & User Management (MVP - Month 1)

#### FR-001: Email Registration
**Priority**: MUST-HAVE (RICE: 150)
**Description**: Users must be able to register with email and password
**Acceptance Criteria**:
- [ ] User provides email, username, password (min 8 chars, 1 uppercase, 1 number, 1 symbol)
- [ ] System sends verification email within 30 seconds
- [ ] Email verification link expires after 24 hours
- [ ] User receives 100 registration bonus points upon verification
- [ ] System prevents duplicate emails and usernames
- [ ] System implements rate limiting (max 5 registration attempts per IP per hour)

**User Story**: "As a new user, I want to sign up with my email so I can start posting and earning points."

**Dependencies**: None (foundational)
**Estimated Effort**: 2 weeks

---

#### FR-002: OAuth2 Social Login (5 Providers)
**Priority**: MUST-HAVE (RICE: 36)
**Description**: Users must be able to sign in with Meta, Reddit, Discord, X, Telegram
**Acceptance Criteria**:
- [ ] Discord OAuth2 integration (highest priority - crypto community standard)
- [ ] X/Twitter OAuth2 integration (crypto influencers)
- [ ] Telegram OAuth2 integration (crypto community)
- [ ] Reddit OAuth2 integration (target Reddit migrants)
- [ ] Meta/Facebook OAuth2 integration (mainstream users)
- [ ] System auto-creates user profile from social data (username, avatar, email)
- [ ] Social login accounts receive 100 registration bonus points
- [ ] System allows linking multiple OAuth2 providers to same account
- [ ] 70%+ users choose social login over email registration
- [ ] <3% login failure rate

**User Story**: "As a crypto user, I want to sign in with my Discord account so I don't need another password."

**Dependencies**: FR-001 (email auth fallback)
**Estimated Effort**: 4 weeks (1 week per provider average)

---

#### FR-003: User Profiles
**Priority**: MUST-HAVE (RICE: 200)
**Description**: Display user profile with identity, reputation, and activity
**Acceptance Criteria**:
- [ ] Profile displays: username, avatar, bio (500 char max), reputation points, level, join date
- [ ] User can upload custom avatar (max 5MB, JPEG/PNG/GIF/WebP)
- [ ] Avatar auto-resized to 256x256px and stored on IPFS
- [ ] Profile shows: total posts, total comments, total likes received
- [ ] Profile displays user progression badge (New User → Admin)
- [ ] Profile URL format: `/u/[username]`
- [ ] 80%+ users add avatar, 50%+ add bio
- [ ] Profile loads in <1 second

**User Story**: "As a user, I want to view my profile to see my reputation and level progress."

**Dependencies**: FR-001, FR-002
**Estimated Effort**: 1 week

---

### 1.2 Core Forum Features (MVP - Months 1-3)

#### FR-004: Create/Read/Update/Delete Posts
**Priority**: MUST-HAVE (RICE: 100)
**Description**: Users create text posts with markdown support
**Acceptance Criteria**:
- [ ] User spends 5 points to create post
- [ ] Post supports markdown (headings, bold, italic, links, code blocks, lists)
- [ ] Post title: 10-300 chars, body: 10-10,000 chars
- [ ] User can edit post within 15 minutes (no point refund)
- [ ] User can delete own post (points not refunded)
- [ ] System auto-saves draft every 30 seconds
- [ ] Post displays: title, body, author, timestamp, edit indicator, like count
- [ ] System prevents spam with rate limiting (max 50 posts/day)
- [ ] New users limited to 5 posts/day first 7 days
- [ ] 500+ posts/day by Month 6, <1% spam posts

**User Story**: "As a creator, I want to write a post about BNB Chain DeFi so I can share my knowledge and earn points."

**Dependencies**: FR-001, FR-003
**Estimated Effort**: 3 weeks

---

#### FR-005: Commenting System
**Priority**: MUST-HAVE (RICE: 150)
**Description**: Nested comments with markdown support
**Acceptance Criteria**:
- [ ] User spends 2 points to create comment
- [ ] Comment supports markdown (same as posts)
- [ ] Comment: 1-2,000 chars max
- [ ] Nested comments 2 levels deep (comment → reply → reply-to-reply)
- [ ] User can edit comment within 15 minutes
- [ ] User can delete own comment (points not refunded)
- [ ] Comment displays: body, author, timestamp, edit indicator, like count
- [ ] System prevents spam (max 200 comments/day)
- [ ] 5+ comments per post avg, 80%+ posts have comments

**User Story**: "As a user, I want to comment on a post to share my thoughts and earn engagement."

**Dependencies**: FR-004
**Estimated Effort**: 2 weeks

---

#### FR-006: Upvote/Like System
**Priority**: MUST-HAVE (RICE: 300)
**Description**: Like posts and comments to reward quality content
**Acceptance Criteria**:
- [ ] User spends 1 point to like post or comment
- [ ] User cannot self-like (system prevents)
- [ ] User can unlike (point refunded)
- [ ] Like count displayed next to content
- [ ] Content creator earns points based on like milestones:
  - 10 likes → +3 points
  - 100 likes → +30 points
  - 1,000 likes → +350 points
- [ ] System prevents like-bombing (max 50 likes/hour)
- [ ] 10+ likes per post avg, 50%+ users like daily

**User Story**: "As a user, I want to like helpful posts so creators earn rewards and quality content rises."

**Dependencies**: FR-004, FR-005
**Estimated Effort**: 1 week

---

#### FR-007: Image Upload (IPFS)
**Priority**: MUST-HAVE (RICE: 42.7)
**Description**: Upload images to posts, stored on IPFS
**Acceptance Criteria**:
- [ ] Supported formats: JPEG, PNG, GIF, WebP (max 10MB per image)
- [ ] Max 5 images per post
- [ ] System auto-compresses images >1MB to <500KB (quality 85%)
- [ ] Images stored on IPFS via Lighthouse SDK (perpetual storage)
- [ ] Image upload progress indicator
- [ ] Image preview before posting
- [ ] Alt text required for accessibility (WCAG 2.1)
- [ ] 60%+ posts have images, <2% upload failures

**User Story**: "As a content creator, I want to upload memes and charts so my posts are more engaging."

**Dependencies**: FR-004, Lighthouse SDK integration
**Estimated Effort**: 3 weeks

---

#### FR-008: Video Embedding
**Priority**: MUST-HAVE (RICE: 120)
**Description**: Embed YouTube/Vimeo/TikTok videos in posts
**Acceptance Criteria**:
- [ ] User pastes YouTube/Vimeo/TikTok URL in post
- [ ] System auto-detects video URL and generates embed code
- [ ] Video player embedded in post (responsive iframe)
- [ ] Thumbnail preview displayed
- [ ] Max 3 video embeds per post
- [ ] 30%+ posts have video embeds, 80%+ videos load correctly

**User Story**: "As a trader, I want to embed YouTube tutorials so I can explain strategies visually."

**Dependencies**: FR-004
**Estimated Effort**: 1 week

---

#### FR-009: Search Functionality
**Priority**: MUST-HAVE (RICE: 75)
**Description**: Full-text search for posts, comments, users
**Acceptance Criteria**:
- [ ] Search bar in navigation (always visible)
- [ ] Search supports: keywords, phrases, user mentions (@username)
- [ ] Search filters: posts only, comments only, users only
- [ ] Search sorting: relevance, most recent, most likes
- [ ] Search results display: title, snippet (100 chars), author, timestamp, likes
- [ ] Search results paginated (20 per page)
- [ ] Search query saved in URL for sharing
- [ ] Search autocomplete suggestions
- [ ] Search results load in <2 seconds
- [ ] 40%+ users use search weekly

**User Story**: "As a user, I want to search for 'PancakeSwap tutorial' so I can find relevant posts."

**Dependencies**: FR-004, FR-005, PostgreSQL full-text search
**Estimated Effort**: 2 weeks

---

### 1.3 Point Economy System (MVP - Months 2-4)

#### FR-010: Point Balance Display
**Priority**: MUST-HAVE (RICE: 100)
**Description**: Display user's current point balance
**Acceptance Criteria**:
- [ ] Point balance displayed in navigation (always visible)
- [ ] Point balance updates in real-time (WebSocket or SSE)
- [ ] Point transactions logged with: action, amount, timestamp, balance after
- [ ] User can view transaction history (paginated)
- [ ] Low balance warning (<10 points) prompts recharge
- [ ] Point balance displays in profile

**User Story**: "As a user, I want to see my point balance so I know if I can post."

**Dependencies**: FR-001
**Estimated Effort**: 1 week

---

#### FR-011: Point Spending
**Priority**: MUST-HAVE (RICE: 300)
**Description**: Deduct points for user actions
**Acceptance Criteria**:
- [ ] System deducts points for:
  - Create post: -5 points
  - Create comment: -2 points
  - Like post/comment: -1 point
  - Create channel: -50 points (Phase 2)
  - Post advertisement: -10 points
- [ ] System prevents action if insufficient balance
- [ ] System shows "Insufficient points" error with recharge prompt
- [ ] 30% of spent points burned (anti-inflation), 70% recyclable
- [ ] Point spending logged in transaction history

**User Story**: "As a user, I want to spend 5 points to create a post about crypto trading strategies."

**Dependencies**: FR-004, FR-005, FR-006
**Estimated Effort**: 2 weeks

---

#### FR-012: Point Earning
**Priority**: MUST-HAVE (RICE: 100)
**Description**: Award points for quality contributions
**Acceptance Criteria**:
- [ ] System awards points for:
  - 10 likes received: +3 points
  - 100 likes received: +30 points
  - 1,000 likes received: +350 points
  - Successful referral: +25 points (new user verifies email)
  - 7-day login streak: +10 points
- [ ] Point rewards credited instantly
- [ ] Point earning notification displayed to user
- [ ] Point earning logged in transaction history

**User Story**: "As a content creator, I want to earn 30 points when my post reaches 100 likes so I'm rewarded for quality."

**Dependencies**: FR-006
**Estimated Effort**: 2 weeks

---

#### FR-013: Crypto Recharge Packages
**Priority**: MUST-HAVE (RICE: 200)
**Description**: Purchase points with BNB Chain crypto (BNB, USDT, BUSD, USDC)
**Acceptance Criteria**:
- [ ] Recharge packages:
  - 5 USDT = 500 points (Starter)
  - 10 USDT = 1,100 points (+10% bonus)
  - 25 USDT = 2,750 points (+10% bonus)
  - 50 USDT = 5,750 points (+15% bonus)
- [ ] User selects package and payment token (BNB/USDT/BUSD/USDC)
- [ ] For USDT: Direct transfer to preset BNB Chain address (no swap)
- [ ] For BNB/BUSD/USDC: Auto-swap to USDT via PancakeSwap V2 Router, then transfer
- [ ] System displays estimated USDT after swap (with slippage)
- [ ] User confirms transaction in MetaMask/WalletConnect
- [ ] System waits for blockchain confirmation (2 confirmations)
- [ ] Points credited to account within 5 minutes of confirmation
- [ ] Transaction history shows: package, amount paid, token used, points received, timestamp
- [ ] <5% transaction failure rate, <3% payment disputes

**User Story**: "As a user, I want to recharge 10 USDT so I can get 1,100 points and post actively."

**Dependencies**: web3.py, PancakeSwap V2 integration, BNB Chain RPC
**Estimated Effort**: 6 weeks

---

#### FR-014: Registration Bonus
**Priority**: MUST-HAVE (RICE: 400)
**Description**: Award 100 points to new verified users
**Acceptance Criteria**:
- [ ] New user receives 100 points after email verification
- [ ] New OAuth2 user receives 100 points after first login
- [ ] Bonus awarded once per user (tracked by email)
- [ ] Bonus notification displayed on first login
- [ ] System prevents bonus for duplicate/spam accounts

**User Story**: "As a new user, I want to receive 100 free points so I can start posting immediately."

**Dependencies**: FR-001, FR-002
**Estimated Effort**: 1 week

---

### 1.4 User Progression System (MVP - Months 3-5)

#### FR-015: User Level Tiers (8 Levels)
**Priority**: MUST-HAVE (RICE: 200)
**Description**: Users progress through 8 tiers based on reputation points
**Acceptance Criteria**:
- [ ] Level 0: New User (0-7 days old, limited to 5 posts/day)
- [ ] Level 1: Contributor (100+ points, 7+ days)
- [ ] Level 2: Regular (500+ points, 30+ days)
- [ ] Level 3: Trusted (2,000+ points, 90+ days)
- [ ] Level 4: Expert (10,000+ points, 180+ days)
- [ ] Level 5: Moderator (50,000+ points, community vote)
- [ ] Level 6: Channel Owner (100,000+ points, owns channel)
- [ ] Level 7: Admin (250,000+ points, community vote)
- [ ] System auto-promotes users when requirements met
- [ ] Level badge displayed in profile and next to username
- [ ] Level-up notification sent to user

**User Story**: "As a contributor, I want to level up to Trusted so I can unlock moderation powers."

**Dependencies**: FR-003, FR-011, FR-012
**Estimated Effort**: 3 weeks

---

#### FR-016: Permissions by Level
**Priority**: MUST-HAVE (RICE: 200)
**Description**: Grant permissions based on user level
**Acceptance Criteria**:
- [ ] New User (L0): 5 posts/day, 20 comments/day, 50 likes/day
- [ ] Contributor (L1): 20 posts/day, 100 comments/day, 100 likes/day
- [ ] Regular (L2): 50 posts/day, 200 comments/day, unlimited likes
- [ ] Trusted (L3): Unlimited posts, can flag content
- [ ] Expert (L4): Can review flagged content, vote on removals
- [ ] Moderator (L5): Can remove content, issue warnings, temp ban users
- [ ] Channel Owner (L6): Can create/manage custom channels
- [ ] Admin (L7): Can appoint moderators, change platform settings
- [ ] System enforces rate limits per level
- [ ] System prevents privilege escalation

**User Story**: "As a Trusted user, I want to flag spam posts so moderators can review them."

**Dependencies**: FR-015
**Estimated Effort**: 2 weeks

---

### 1.5 Moderation System (MVP - Months 4-6)

#### FR-017: Flag Content
**Priority**: MUST-HAVE (RICE: 50)
**Description**: Users can flag inappropriate content
**Acceptance Criteria**:
- [ ] User clicks "Flag" button on post/comment
- [ ] User selects reason: Spam, Harassment, Illegal, Scam, Other
- [ ] User provides optional description (500 chars)
- [ ] System logs flag with: content ID, flagger, reason, timestamp
- [ ] System increments flag counter on content
- [ ] Content with 5+ flags auto-hidden (pending review)
- [ ] Moderator receives notification for flagged content
- [ ] Only Trusted+ users can flag (L3+)

**User Story**: "As a Trusted user, I want to flag a spam post so moderators can review it."

**Dependencies**: FR-004, FR-005, FR-015
**Estimated Effort**: 2 weeks

---

#### FR-018: Community Voting on Removals
**Priority**: MUST-HAVE (RICE: 30)
**Description**: Community votes on flagged content removal
**Acceptance Criteria**:
- [ ] Expert+ users (L4+) can vote on flagged content
- [ ] Voting options: Remove, Keep, Needs Discussion
- [ ] Vote weight based on user level:
  - Expert (L4): 1 vote
  - Moderator (L5): 3 votes
  - Channel Owner (L6): 5 votes
  - Admin (L7): 10 votes
- [ ] Content removed if weighted votes ≥50% for "Remove"
- [ ] Content kept if weighted votes ≥50% for "Keep"
- [ ] If no majority after 48 hours, escalate to Moderators
- [ ] Voting results displayed to voters

**User Story**: "As an Expert, I want to vote to remove a scam post so the community stays safe."

**Dependencies**: FR-017, FR-015
**Estimated Effort**: 3 weeks

---

#### FR-019: Moderator Actions
**Priority**: MUST-HAVE (RICE: 40)
**Description**: Moderators can remove content, warn users, issue temp bans
**Acceptance Criteria**:
- [ ] Moderator (L5+) can:
  - Remove post/comment (with reason)
  - Issue warning to user (logged in user history)
  - Temporary ban user (1 day, 7 days, 30 days)
  - Permanent ban user (requires Admin vote)
- [ ] All moderator actions logged with: action, target user/content, reason, timestamp
- [ ] All actions visible in public moderation log
- [ ] User receives notification of moderator action
- [ ] User can appeal ban (reviewed by other moderators)

**User Story**: "As a Moderator, I want to remove a spam post and warn the user to prevent future spam."

**Dependencies**: FR-015, FR-017
**Estimated Effort**: 3 weeks

---

### 1.6 Mobile Responsiveness (MVP - Month 6)

#### FR-020: Responsive Design
**Priority**: MUST-HAVE (RICE: 100)
**Description**: Platform works on all device sizes
**Acceptance Criteria**:
- [ ] Layout adapts to: desktop (>1024px), tablet (768-1024px), mobile (320-767px)
- [ ] Navigation collapses to hamburger menu on mobile
- [ ] Touch-friendly buttons (min 44x44px tap targets)
- [ ] Text readable without zooming (min 16px font)
- [ ] Images scale to fit screen width
- [ ] Forms usable on mobile (autofocus, autocomplete, validation)
- [ ] 90%+ users on mobile have good experience (survey)

**User Story**: "As a mobile user, I want to browse posts on my phone so I can engage anywhere."

**Dependencies**: All MVP features
**Estimated Effort**: 4 weeks

---

### 1.7 GDPR Compliance (MVP - Month 6)

#### FR-021: Data Export
**Priority**: MUST-HAVE (RICE: 25)
**Description**: Users can export their data
**Acceptance Criteria**:
- [ ] User clicks "Export Data" in settings
- [ ] System generates JSON file with: profile, posts, comments, likes, transactions
- [ ] Export includes IPFS links to uploaded images
- [ ] Export delivered via email within 24 hours
- [ ] Export deleted after 7 days

**User Story**: "As a user, I want to export my data so I can backup my content."

**Dependencies**: FR-001, GDPR requirement
**Estimated Effort**: 1 week

---

#### FR-022: Data Deletion
**Priority**: MUST-HAVE (RICE: 25)
**Description**: Users can request account deletion
**Acceptance Criteria**:
- [ ] User clicks "Delete Account" in settings
- [ ] System shows warning: "This action is permanent. All points will be lost."
- [ ] User confirms deletion (re-enter password)
- [ ] System anonymizes user data:
  - Username → "deleted_user_[ID]"
  - Email → "[deleted]"
  - Avatar → default placeholder
  - Posts/comments remain but author anonymized
- [ ] System sends confirmation email after deletion
- [ ] Account reactivation not possible

**User Story**: "As a user, I want to delete my account so I can exercise my right to be forgotten."

**Dependencies**: FR-001, GDPR requirement
**Estimated Effort**: 2 weeks

---

## 2. Non-Functional Requirements

### 2.1 Performance Requirements

#### NFR-001: Response Time
**Requirement**: 95% of requests must complete in <2 seconds
**Measurement**: Server-side timing middleware, CDN analytics
**Acceptance Criteria**:
- [ ] Homepage loads in <1.5 seconds (cached)
- [ ] Post creation <1 second (excluding image upload)
- [ ] Search results <2 seconds
- [ ] Point balance update <500ms (WebSocket)
- [ ] Image upload <5 seconds (10MB image)

**Rationale**: Industry standard for web applications (Google PageSpeed Insights)

---

#### NFR-002: Throughput
**Requirement**: Support 1,000 concurrent users (Month 12 target: 10,000 MAU)
**Measurement**: Load testing (Locust, k6)
**Acceptance Criteria**:
- [ ] System handles 100 requests/second without degradation
- [ ] Database handles 500 queries/second
- [ ] Redis cache hit rate >90%
- [ ] System auto-scales to 5 instances under load

**Rationale**: 10,000 MAU × 10% concurrent = 1,000 concurrent users

---

#### NFR-003: Availability
**Requirement**: 99.5% uptime (43.8 hours downtime/year)
**Measurement**: Uptime monitoring (UptimeRobot, Datadog)
**Acceptance Criteria**:
- [ ] Max 3.65 hours planned maintenance per month
- [ ] Max 1 hour unplanned downtime per month
- [ ] Auto-restart on crash (<5 min downtime)
- [ ] Database automated backups every 6 hours

**Rationale**: Industry standard for SaaS applications (not mission-critical)

---

### 2.2 Scalability Requirements

#### NFR-004: Horizontal Scaling
**Requirement**: System must scale horizontally to handle growth
**Acceptance Criteria**:
- [ ] Stateless FastAPI instances (no in-memory sessions)
- [ ] Redis for session storage (shared across instances)
- [ ] PostgreSQL connection pooling (max 100 connections)
- [ ] IPFS content delivery via dedicated gateway
- [ ] CDN for static assets (Cloudflare/CloudFront)

**Rationale**: Prepare for 10x growth (100,000 MAU by Year 2)

---

#### NFR-005: Database Performance
**Requirement**: Database queries <100ms avg, <500ms p95
**Acceptance Criteria**:
- [ ] All foreign keys indexed
- [ ] Full-text search index on posts/comments
- [ ] Composite index on user_id + timestamp (for feeds)
- [ ] Database query analysis (EXPLAIN) shows index usage
- [ ] Slow query log enabled (queries >500ms)

**Rationale**: PostgreSQL best practices, Supabase/Neon performance guidelines

---

### 2.3 Usability Requirements

#### NFR-006: Accessibility (WCAG 2.1 Level AA)
**Requirement**: Platform accessible to users with disabilities
**Acceptance Criteria**:
- [ ] All images have alt text
- [ ] Color contrast ratio ≥4.5:1 (text), ≥3:1 (UI components)
- [ ] Keyboard navigation for all features (no mouse required)
- [ ] Screen reader compatible (ARIA labels, semantic HTML)
- [ ] Forms have error messages and validation
- [ ] No flashing content (seizure prevention)

**Rationale**: WCAG 2.1 Level AA compliance (legal requirement in EU, US)

---

#### NFR-007: Browser Compatibility
**Requirement**: Support latest 2 versions of major browsers
**Acceptance Criteria**:
- [ ] Chrome 120+ (90% market share)
- [ ] Safari 17+ (iOS requirement)
- [ ] Firefox 120+
- [ ] Edge 120+
- [ ] No IE11 support (deprecated 2022)

**Rationale**: Balance compatibility with development effort (evergreen browsers)

---

### 2.4 Maintainability Requirements

#### NFR-008: Code Quality
**Requirement**: Maintain high code quality for long-term maintainability
**Acceptance Criteria**:
- [ ] Python code follows PEP 8 style guide
- [ ] Code formatted with Black (line length 100)
- [ ] Linted with Ruff (no critical issues)
- [ ] Type hints for all functions (MyPy validation)
- [ ] Docstrings for all public functions (Google style)
- [ ] Code coverage ≥80% (pytest-cov)

**Rationale**: Industry best practices (Google Python Style Guide, PEP 8)

---

#### NFR-009: Documentation
**Requirement**: Comprehensive documentation for developers and users
**Acceptance Criteria**:
- [ ] README.md with setup instructions
- [ ] API documentation (OpenAPI/Swagger)
- [ ] Database schema diagram (ERD)
- [ ] Architecture decision records (ADR)
- [ ] User guide for non-technical users
- [ ] Deployment runbook

**Rationale**: Onboard new developers, reduce bus factor

---

## 3. Technical Requirements

### 3.1 Technology Stack

#### TR-001: Backend Framework
**Technology**: FastAPI 0.115+
**Rationale**:
- Async support (200-300% faster than Django/Flask)
- Auto-generated OpenAPI docs
- Type safety with Pydantic
- Production-proven (Netflix, Uber, Microsoft)

---

#### TR-002: Database
**Technology**: PostgreSQL 16+ (Supabase or Neon serverless)
**Rationale**:
- ACID compliance (point transactions require consistency)
- Full-text search (built-in, no Elasticsearch needed)
- JSON support (flexible schema for metadata)
- Serverless autoscaling (Supabase/Neon)

---

#### TR-003: Caching Layer
**Technology**: Redis 7+ (Upstash or Railway)
**Rationale**:
- Session storage (shared across FastAPI instances)
- Rate limiting (token bucket algorithm)
- Real-time features (Pub/Sub for point balance updates)
- Leaderboard (sorted sets for rankings)

---

#### TR-004: Blockchain
**Technology**: BNB Chain (Mainnet), web3.py 7+
**Rationale**:
- Low gas fees ($0.01 per transaction)
- Sub-second finality (fast confirmations)
- 58M monthly active users (established ecosystem)
- PancakeSwap V2 integration for token swaps

---

#### TR-005: File Storage
**Technology**: IPFS via Lighthouse SDK (Python)
**Rationale**:
- Perpetual storage (pay once, store forever)
- Decentralized (censorship-resistant)
- Cost-effective ($20/month for MVP)
- Dedicated gateway for fast retrieval

---

#### TR-006: Frontend
**Technology**: Jinja2 templates (server-side rendering)
**Rationale**:
- SEO-friendly (no JavaScript required for indexing)
- Fast initial page load (no client-side framework overhead)
- Simple deployment (no build step)
- Progressive enhancement (works without JavaScript)

---

### 3.2 Infrastructure Requirements

#### TR-007: Hosting
**Technology**: Railway or Render (auto-deploy from Git)
**Rationale**:
- Auto-scaling based on traffic
- Zero-downtime deployments
- Integrated PostgreSQL and Redis
- $100-200/month for MVP

---

#### TR-008: Monitoring
**Technology**: Sentry (error tracking), Datadog (metrics)
**Rationale**:
- Real-time error alerts
- Performance monitoring (APM)
- User session replay (debugging)
- Free tier for MVP

---

## 4. Security Requirements

### 4.1 Authentication & Authorization

#### SR-001: Password Security
**Requirement**: Passwords must be securely stored and validated
**Acceptance Criteria**:
- [ ] Passwords hashed with bcrypt (work factor 12)
- [ ] Password requirements: min 8 chars, 1 uppercase, 1 number, 1 symbol
- [ ] Password strength meter displayed during registration
- [ ] Rate limiting on login attempts (5 attempts per IP per hour)
- [ ] Account lockout after 10 failed attempts (1 hour)

**Rationale**: OWASP Authentication Cheat Sheet

---

#### SR-002: Session Management
**Requirement**: User sessions must be secure and expire appropriately
**Acceptance Criteria**:
- [ ] Session tokens generated with cryptographically secure random (secrets.token_urlsafe)
- [ ] Session expires after 7 days of inactivity
- [ ] Session invalidated on logout
- [ ] Session cookie: HttpOnly, Secure, SameSite=Strict
- [ ] "Remember Me" extends session to 30 days (opt-in)

**Rationale**: OWASP Session Management Cheat Sheet

---

### 4.2 Input Validation

#### SR-003: XSS Prevention
**Requirement**: Prevent Cross-Site Scripting attacks
**Acceptance Criteria**:
- [ ] All user input escaped before rendering (Jinja2 auto-escape)
- [ ] Markdown rendered with bleach library (sanitize HTML)
- [ ] Allowed tags: p, h1-h6, strong, em, a, ul, ol, li, code, pre
- [ ] Disallowed: script, iframe, object, embed, form
- [ ] Content Security Policy (CSP) header: `script-src 'self'`

**Rationale**: OWASP XSS Prevention Cheat Sheet

---

#### SR-004: SQL Injection Prevention
**Requirement**: Prevent SQL injection attacks
**Acceptance Criteria**:
- [ ] All database queries use parameterized queries (SQLAlchemy ORM)
- [ ] No raw SQL with string concatenation
- [ ] Database user has limited permissions (no DROP, ALTER)
- [ ] Input validation for all user-provided data

**Rationale**: OWASP SQL Injection Prevention Cheat Sheet

---

### 4.3 Blockchain Security

#### SR-005: Smart Contract Interaction
**Requirement**: Securely interact with BNB Chain smart contracts
**Acceptance Criteria**:
- [ ] Validate transaction signatures before processing
- [ ] Verify transaction confirmation (minimum 2 confirmations)
- [ ] Check transaction receipt for success/failure
- [ ] Log all blockchain transactions for audit
- [ ] Handle transaction failures gracefully (refund points if applicable)

**Rationale**: BNB Chain security best practices

---

#### SR-006: Private Key Management
**Requirement**: Backend private keys must be securely stored
**Acceptance Criteria**:
- [ ] Private key stored in environment variable (never in code)
- [ ] Private key encrypted at rest (KMS or similar)
- [ ] Private key never logged or exposed in errors
- [ ] Separate keys for development/staging/production

**Rationale**: OWASP Cryptographic Storage Cheat Sheet

---

### 4.4 Rate Limiting

#### SR-007: API Rate Limiting
**Requirement**: Prevent abuse and DDoS attacks
**Acceptance Criteria**:
- [ ] Registration: 5 per IP per hour
- [ ] Login: 10 per IP per hour
- [ ] Post creation: 50 per user per day
- [ ] Comment creation: 200 per user per day
- [ ] Like action: 100 per user per hour (prevent like-bombing)
- [ ] Rate limit headers: X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Reset

**Rationale**: OWASP API Security Top 10

---

## 5. Compliance Requirements

### 5.1 GDPR (General Data Protection Regulation)

#### CR-001: Data Processing Lawfulness
**Requirement**: Process personal data lawfully, fairly, and transparently
**Acceptance Criteria**:
- [ ] Privacy policy published and linked in footer
- [ ] Clear consent for data processing during registration
- [ ] Purpose of data collection explained
- [ ] Data retention policy: 3 years inactive account deletion

**Rationale**: GDPR Article 5 (Principles), Article 6 (Lawfulness)

---

#### CR-002: Right to Access
**Requirement**: Users can request their data (FR-021)
**Acceptance Criteria**: See FR-021

**Rationale**: GDPR Article 15

---

#### CR-003: Right to Erasure
**Requirement**: Users can request account deletion (FR-022)
**Acceptance Criteria**: See FR-022

**Rationale**: GDPR Article 17

---

#### CR-004: Data Breach Notification
**Requirement**: Notify authorities and users of data breaches within 72 hours
**Acceptance Criteria**:
- [ ] Incident response plan documented
- [ ] Monitoring for suspicious activity (Sentry, Datadog)
- [ ] Breach notification email template prepared
- [ ] Contact: Data Protection Officer (DPO) email in privacy policy

**Rationale**: GDPR Article 33 (Notification to authority), Article 34 (Notification to data subject)

---

### 5.2 AML/KYC (Anti-Money Laundering / Know Your Customer)

#### CR-005: Transaction Monitoring
**Requirement**: Monitor crypto transactions for suspicious activity
**Acceptance Criteria**:
- [ ] Log all crypto recharge transactions (amount, token, address, timestamp)
- [ ] Flag transactions >$1,000 USDT for manual review
- [ ] Block transactions from sanctioned addresses (OFAC list)
- [ ] Quarterly review of transaction patterns

**Rationale**: FinCEN guidance for virtual currency, FATF Recommendations

**Note**: Full KYC not required for MVP (no fiat off-ramp, no user-to-user transfers)

---

## 6. Success Criteria

### 6.1 MVP Launch (Month 6) Success Metrics

#### SC-001: User Acquisition
**Target**: 1,000 registered users by Month 6
**Measurement**: User registration count (PostgreSQL query)
**Current Baseline**: 0 (greenfield project)

---

#### SC-002: User Engagement
**Target**: 30% DAU/MAU ratio (300 DAU, 1,000 MAU)
**Measurement**: Daily active users ÷ Monthly active users
**Industry Benchmark**: 20-30% for social platforms (SimilarWeb)

---

#### SC-003: Content Creation
**Target**: 500+ posts per day by Month 6
**Measurement**: Post creation count (PostgreSQL query)
**Quality Metric**: <1% spam posts (flagged/removed)

---

#### SC-004: Revenue
**Target**: $1,000 MRR by Month 6 (10% of Month 12 target)
**Measurement**: Crypto recharge transaction sum (blockchain analytics)
**Assumptions**: 1,000 MAU, 2% conversion, $50 ARPU

---

### 6.2 Full Launch (Month 12) Success Metrics

#### SC-005: User Growth
**Target**: 10,000 MAU by Month 12
**Measurement**: Monthly active users (login within 30 days)

---

#### SC-006: Revenue Target
**Target**: $12,000 MRR by Month 12
**Measurement**: Total monthly revenue from crypto recharge + verified badges + custom channels

---

#### SC-007: User Satisfaction
**Target**: NPS (Net Promoter Score) ≥40
**Measurement**: In-app survey (quarterly)
**Industry Benchmark**: NPS 30-50 for social platforms

---

## 7. Requirements Traceability Matrix

| Requirement ID | Feature | Priority | RICE Score | Effort (Weeks) | Month | Dependencies | Success Metric |
|---------------|---------|----------|-----------|---------------|-------|--------------|----------------|
| FR-001 | Email Registration | MUST | 150 | 2 | 1 | None | 95%+ verification rate |
| FR-002 | OAuth2 Social Login | MUST | 36 | 4 | 1 | FR-001 | 70%+ choose social login |
| FR-003 | User Profiles | MUST | 200 | 1 | 1 | FR-001, FR-002 | 80%+ add avatar |
| FR-004 | Create/Read/Update/Delete Posts | MUST | 100 | 3 | 1-2 | FR-001, FR-003 | 500+ posts/day by M6 |
| FR-005 | Commenting System | MUST | 150 | 2 | 2 | FR-004 | 5+ comments/post avg |
| FR-006 | Upvote/Like System | MUST | 300 | 1 | 2 | FR-004, FR-005 | 10+ likes/post avg |
| FR-007 | Image Upload (IPFS) | MUST | 42.7 | 3 | 2-3 | FR-004, Lighthouse | 60%+ posts have images |
| FR-008 | Video Embedding | MUST | 120 | 1 | 3 | FR-004 | 30%+ posts have videos |
| FR-009 | Search Functionality | MUST | 75 | 2 | 3 | FR-004, FR-005 | 40%+ use search weekly |
| FR-010 | Point Balance Display | MUST | 100 | 1 | 2 | FR-001 | Real-time updates |
| FR-011 | Point Spending | MUST | 300 | 2 | 2-3 | FR-004, FR-005, FR-006 | 30% burn rate |
| FR-012 | Point Earning | MUST | 100 | 2 | 3 | FR-006 | Instant rewards |
| FR-013 | Crypto Recharge Packages | MUST | 200 | 6 | 3-4 | web3.py, PancakeSwap | <5% failure rate |
| FR-014 | Registration Bonus | MUST | 400 | 1 | 1 | FR-001, FR-002 | 100 points/user |
| FR-015 | User Level Tiers (8 Levels) | MUST | 200 | 3 | 3-4 | FR-003, FR-011 | Auto-promotion |
| FR-016 | Permissions by Level | MUST | 200 | 2 | 4 | FR-015 | Enforced rate limits |
| FR-017 | Flag Content | MUST | 50 | 2 | 4-5 | FR-004, FR-005, FR-015 | <1% false positives |
| FR-018 | Community Voting on Removals | MUST | 30 | 3 | 5 | FR-017, FR-015 | Weighted votes |
| FR-019 | Moderator Actions | MUST | 40 | 3 | 5 | FR-015, FR-017 | Public mod log |
| FR-020 | Responsive Design | MUST | 100 | 4 | 6 | All MVP features | 90%+ mobile satisfaction |
| FR-021 | Data Export (GDPR) | MUST | 25 | 1 | 6 | FR-001, GDPR | 24h delivery |
| FR-022 | Data Deletion (GDPR) | MUST | 25 | 2 | 6 | FR-001, GDPR | Anonymized data |

**Total MVP Effort**: 53 weeks (13 months with parallelization → 6 months with 2-person team)

---

## 8. Out of Scope (Phase 2 - Months 7-12)

The following features are prioritized for Phase 2 after MVP launch:

1. **Wiki/Knowledge Base** (RICE: 18) - 6 weeks
2. **Voice Sessions** (RICE: 12) - 8 weeks (40% confidence)
3. **Custom Channels** (RICE: 20) - 3 weeks
4. **Verified Badges** (RICE: 30) - 2 weeks
5. **Advanced Analytics Dashboard** (RICE: 15) - 4 weeks
6. **Notification System** (RICE: 50) - 3 weeks
7. **Referral Rewards Program** (RICE: 35) - 2 weeks
8. **Leaderboards & Rankings** (RICE: 25) - 2 weeks
9. **Daily Login Streak** (RICE: 40) - 1 week
10. **Downvote System** (RICE: 20) - 2 weeks
11. **Post Scheduling** (RICE: 10) - 2 weeks
12. **Content Drafts Auto-Save** (RICE: 30) - 1 week
13. **User Mentions (@username)** (RICE: 40) - 2 weeks
14. **Hashtag System** (RICE: 25) - 2 weeks
15. **Advanced Moderation Tools** (RICE: 30) - 3 weeks

**Total Phase 2 Effort**: 43 weeks (10.75 months with parallelization → 6 months with 2-person team)

---

## 9. Assumptions & Constraints

### 9.1 Assumptions

1. **Team Size**: 1-2 full-stack developers (solo founder or small team)
2. **Working Hours**: 40 hours/week (160 hours/month)
3. **Development Environment**: macOS/Linux with Python 3.11+, PostgreSQL, Redis
4. **Third-Party Services**:
   - Supabase/Neon free tier sufficient for MVP (<10,000 rows)
   - Lighthouse IPFS free tier sufficient (<1,000 uploads/month)
   - Railway/Render free tier sufficient for MVP (<1,000 MAU)
5. **User Behavior**:
   - 70%+ users choose social login (industry average)
   - 5% conversion to paying users (conservative estimate)
   - $20 ARPU (average recharge package: 10 USDT)

### 9.2 Constraints

1. **Budget**: <$500/month infrastructure costs for MVP
2. **Timeline**: 6-month MVP deadline (hard constraint for market timing)
3. **Compliance**: GDPR compliance required (serving EU users)
4. **Technology**: No native mobile app (web-only for MVP)
5. **Blockchain**: BNB Chain only (no multi-chain support in MVP)
6. **Payments**: Crypto-only (no fiat on-ramp in MVP)

---

## 10. Change Management

### 10.1 Requirements Change Process

1. **Request**: Stakeholder submits change request with rationale
2. **Impact Analysis**: Plan Agent assesses impact on timeline, budget, dependencies
3. **Prioritization**: Re-calculate RICE score, compare to existing features
4. **Approval**: Stakeholder approves change and accepts trade-offs
5. **Update**: Update requirements.md, roadmap.md, risk-register.md
6. **Communication**: Notify all agents and stakeholders

### 10.2 Version Control

This document is version-controlled in Git. All changes must be:
- Committed with descriptive message
- Reviewed by Plan Agent
- Approved by stakeholder before implementation

---

## 11. Glossary

| Term | Definition |
|------|------------|
| **DAU** | Daily Active Users (logged in within 24 hours) |
| **MAU** | Monthly Active Users (logged in within 30 days) |
| **RICE** | Reach × Impact × Confidence / Effort (prioritization framework) |
| **MoSCoW** | Must-have, Should-have, Could-have, Won't-have (prioritization) |
| **ARPU** | Average Revenue Per User |
| **MRR** | Monthly Recurring Revenue |
| **IPFS** | InterPlanetary File System (decentralized file storage) |
| **BNB Chain** | Binance Smart Chain (blockchain for crypto payments) |
| **USDT** | Tether (stablecoin pegged to USD) |
| **PancakeSwap** | Decentralized exchange (DEX) on BNB Chain |
| **OAuth2** | Open Authorization 2.0 (social login protocol) |
| **GDPR** | General Data Protection Regulation (EU privacy law) |
| **WCAG** | Web Content Accessibility Guidelines |
| **NFR** | Non-Functional Requirement |
| **SR** | Security Requirement |
| **CR** | Compliance Requirement |
| **TR** | Technical Requirement |

---

## 12. Approvals

| Role | Name | Signature | Date |
|------|------|-----------|------|
| **Product Owner** | [User] | [Pending] | [Pending] |
| **Plan Agent** | Claude | ✅ Approved | 2025-10-21 |
| **Design Agent** | [Pending] | [Pending] | [Pending] |

---

## Document End

**Next Step**: Use `/ux` to create user experience design based on these requirements.

The UX Agent will use this requirements document to create:
- User flows and journey maps
- Wireframes for all 22 MVP features
- Design system (colors, typography, components)
- Accessibility report (WCAG 2.1 Level AA compliance)
